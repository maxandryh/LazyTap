<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LazyTap WebApp</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      height: 100vh; text-align: center;
      background: linear-gradient(135deg, #f5e9d3, #d9ccc4, #c4b7a6);
      background-size: 400% 400%;
      animation: gradientBG 20s ease infinite;
      color: #4b3b2b;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    #tapCount {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 20px;
    }

    #levelInfo {
      font-size: 1.2em;
      margin-bottom: 10px;
    }

    #xpBarContainer {
      width: 80%;
      max-width: 300px;
      height: 10px;
      background: #ccc;
      border-radius: 5px;
      overflow: hidden;
      margin-bottom: 30px;
    }

    #xpBar {
      height: 100%;
      background: #4CAF50;
      width: 0%;
      transition: width 0.3s;
    }

    #tapButton {
      width: 140px;
      height: 140px;
      border-radius: 70px;
      border: none;
      background-color: #4CAF50;
      color: white;
      font-size: 2em;
      cursor: pointer;
      box-shadow: 0 6px 12px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;
      margin-bottom: 20px;
    }

    #tapButton:hover { background-color: #45a049; }

    #tapButton:active {
      transform: scale(0.9);
      box-shadow: 0 0 15px 4px #4CAF50;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
    }

    #resetButton {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 1em;
      cursor: pointer;
    }

    #iconsRow {
      margin-top: 40px;
      width: 90%;
      max-width: 400px;
      display: flex;
      justify-content: space-around;
    }

    .iconButton {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      color: #666;
      font-size: 0.9em;
      user-select: none;
    }

    .iconButton:hover { color: #4CAF50; }

    .iconImg {
      width: 40px;
      height: 40px;
      margin-bottom: 8px;
    }
  </style>
</head>
<body>

<div id="tapCount">–¢–∞–ø—ñ–≤: 1000</div>
<div id="levelInfo">–†—ñ–≤–µ–Ω—å: 1 | XP: 0 / 100</div>
<div id="xpBarContainer"><div id="xpBar"></div></div>
<button id="tapButton" aria-label="–¢–∞–ø –∫–Ω–æ–ø–∫–∞">üîò</button>
<button id="resetButton">Reset</button>
<div>
  –í–∞—à —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∏–π –∫–æ–¥: <strong id="refCodeDisplay"></strong><br/>
  –ü–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è —Ä–µ—Ñ–µ—Ä–∞–ª—ñ–≤: <input type="text" id="refLink" readonly style="width:300px" />
</div>

<div id="iconsRow">
  <div class="iconButton" onclick="alert('–†–µ—Ñ–µ—Ä–∞–ª')">
    <img class="iconImg" src="https://img.icons8.com/ios-filled/50/000000/referral.png" alt="–†–µ—Ñ–µ—Ä–∞–ª" />
    –†–µ—Ñ–µ—Ä–∞–ª
  </div>
  <div class="iconButton" onclick="window.open('earn.html', '_blank')">
    <img class="iconImg" src="https://img.icons8.com/ios-filled/50/000000/money-bag.png" alt="Earn" />
    Earn
  </div>
  <div class="iconButton" onclick="window.open('boost.html', '_blank')">
    <img class="iconImg" src="https://img.icons8.com/ios-filled/50/000000/rocket.png" alt="Boost" />
    Boost
  </div>
  <div class="iconButton" onclick="window.open('skins.html', '_blank')">
    <img class="iconImg" src="https://img.icons8.com/ios-filled/50/000000/t-shirt.png" alt="Skins" />
    Skins
  </div>
</div>

<script>
  const tapCountElem = document.getElementById('tapCount');
  const levelInfoElem = document.getElementById('levelInfo');
  const xpBar = document.getElementById('xpBar');
  const tapButton = document.getElementById('tapButton');
  const resetButton = document.getElementById('resetButton');
  const urlParams = new URLSearchParams(window.location.search);
  const ref = urlParams.get('ref');

if (ref && !localStorage.getItem('referredBy')) {
  localStorage.setItem('referredBy', ref);
}


  let taps = parseInt(localStorage.getItem('taps')) || 0;
  let boost = parseInt(localStorage.getItem('boost')) || 1;
  let xp = parseInt(localStorage.getItem('xp')) || 0;
  let level = parseInt(localStorage.getItem('level')) || 1;
  let energy = parseInt(localStorage.getItem('energy')) || 1000;

  const maxEnergy = 1000;
  const energyRestoreRate = 1; // +1 –∑–∞ 1 —Å–µ–∫

  function xpForNextLevel(level) {
    return 100 + (level - 1) * 50;
  }

  function boostPrice(boostLevel) {
    return 100 * Math.pow(2, boostLevel - 1); // 100, 200, 400, 800...
  }

  function updateDisplay() {
    tapCountElem.textContent = `–¢–∞–ø—ñ–≤: ${taps} | Boost: x${boost} | ‚ö°Ô∏è${energy}`;
    levelInfoElem.textContent = `–†—ñ–≤–µ–Ω—å: ${level} | XP: ${xp} / ${xpForNextLevel(level)}`;
    const percent = Math.min((xp / xpForNextLevel(level)) * 100, 100);
    xpBar.style.width = `${percent}%`;
  }
  function generateReferralCode() {
  return 'user-' + Math.random().toString(36).substr(2, 9);
}

let myReferralCode = localStorage.getItem('referralCode');
if (!myReferralCode) {
  myReferralCode = generateReferralCode();
  localStorage.setItem('referralCode', myReferralCode);
}

  function applySkin() {
    const skin = localStorage.getItem('skin') || 'green';
    switch (skin) {
      case 'red': tapButton.style.backgroundColor = '#e74c3c'; break;
      case 'yellow': tapButton.style.backgroundColor = '#f1c40f'; break;
      default: tapButton.style.backgroundColor = '#4CAF50';
    }
  }

  applySkin();
  updateDisplay();

  tapButton.onclick = () => {
    if (energy > 0) {
      taps += boost;
      xp += 1;
      energy -= 1;

      while (xp >= xpForNextLevel(level)) {
        xp -= xpForNextLevel(level);
        level++;
        alert(`üéâ –ù–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å: ${level}`);
      }

      localStorage.setItem('taps', taps);
      localStorage.setItem('xp', xp);
      localStorage.setItem('level', level);
      localStorage.setItem('energy', energy);
      updateDisplay();
    } else {
      alert('–ù–µ–º–∞—î –µ–Ω–µ—Ä–≥—ñ—ó! –ó–∞—á–µ–∫–∞–π –∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥ ‚è≥');
    }
  };

  resetButton.onclick = () => {
    taps = 0;
    boost = 1;
    xp = 0;
    level = 1;
    energy = maxEnergy;
    localStorage.setItem('taps', taps);
    localStorage.setItem('boost', boost);
    localStorage.setItem('xp', xp);
    localStorage.setItem('level', level);
    localStorage.setItem('energy', energy);
    updateDisplay();
  };

  // –ê–≤—Ç–æ–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –µ–Ω–µ—Ä–≥—ñ—ó
  setInterval(() => {
    if (energy < maxEnergy) {
      energy += energyRestoreRate;
      if (energy > maxEnergy) energy = maxEnergy;
      localStorage.setItem('energy', energy);
      updateDisplay();
    }
  }, 1000);

  // –ü–æ–∫—É–ø–∫–∞ boost –∑–∞ —Ç–∞–ø–∏
  document.addEventListener('keydown', (e) => {
    if (e.key === 'b') { // –Ω–∞—Ç–∏—Å–Ω–∏ 'b' –¥–ª—è –ø–æ–∫—É–ø–∫–∏ boost
      const price = boostPrice(boost);
      if (taps >= price) {
        taps -= price;
        boost++;
        alert(`‚úÖ –ö—É–ø–ª–µ–Ω–æ Boost! –¢–µ–ø–µ—Ä x${boost}`);
        localStorage.setItem('boost', boost);
        localStorage.setItem('taps', taps);
        updateDisplay();
      } else {
        alert(`‚ùå –ü–æ—Ç—Ä—ñ–±–Ω–æ ${price} —Ç–∞–ø—ñ–≤ –¥–ª—è –±—É—Å—Ç—É`);
      }
    }
  });

  // –Ø–∫—â–æ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –∑ —ñ–Ω—à–æ—ó –≤–∫–ª–∞–¥–∫–∏
  window.addEventListener('storage', (event) => {
    if (event.key === 'boost') boost = parseInt(event.newValue) || 1;
    if (event.key === 'taps') taps = parseInt(event.newValue) || 0;
    if (event.key === 'xp') xp = parseInt(event.newValue) || 0;
    if (event.key === 'level') level = parseInt(event.newValue) || 1;
    if (event.key === 'energy') energy = parseInt(event.newValue) || maxEnergy;
    if (event.key === 'skin') applySkin();
    updateDisplay();
  });
  document.getElementById('refCodeDisplay').textContent = myReferralCode;
  document.getElementById('refLink').value = `${window.location.origin}${window.location.pathname}?ref=${myReferralCode}`;

</script>

</body>
</html>
